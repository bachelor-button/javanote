<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>day12 Filter&amp;Listener&amp;书城项目第五阶段 | Java全栈</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Java 基础, Java 部分源码, JVM, Spring, Spring Boot, Spring Cloud, 数据库原理, MySQL, ElasticSearch, Docker, Linux, 分布式, 中间件, Git">
    
    <link rel="preload" href="/javanote/assets/css/0.styles.1d83b9a0.css" as="style"><link rel="preload" href="/javanote/assets/js/app.4d8a0605.js" as="script"><link rel="preload" href="/javanote/assets/js/11.31b4bfe5.js" as="script"><link rel="preload" href="/javanote/assets/js/101.cf545769.js" as="script"><link rel="prefetch" href="/javanote/assets/js/10.c191a387.js"><link rel="prefetch" href="/javanote/assets/js/100.f858324b.js"><link rel="prefetch" href="/javanote/assets/js/102.70c05b3a.js"><link rel="prefetch" href="/javanote/assets/js/103.f1004525.js"><link rel="prefetch" href="/javanote/assets/js/104.0d76607f.js"><link rel="prefetch" href="/javanote/assets/js/105.1706f100.js"><link rel="prefetch" href="/javanote/assets/js/106.c2ff977c.js"><link rel="prefetch" href="/javanote/assets/js/107.5aede27e.js"><link rel="prefetch" href="/javanote/assets/js/108.8ceb754f.js"><link rel="prefetch" href="/javanote/assets/js/109.0921def7.js"><link rel="prefetch" href="/javanote/assets/js/110.1b5f3a78.js"><link rel="prefetch" href="/javanote/assets/js/111.60c4a726.js"><link rel="prefetch" href="/javanote/assets/js/112.a779216c.js"><link rel="prefetch" href="/javanote/assets/js/113.b5d94b79.js"><link rel="prefetch" href="/javanote/assets/js/114.c6f877f7.js"><link rel="prefetch" href="/javanote/assets/js/115.47ecb381.js"><link rel="prefetch" href="/javanote/assets/js/116.92ec84e7.js"><link rel="prefetch" href="/javanote/assets/js/117.e4829b5a.js"><link rel="prefetch" href="/javanote/assets/js/118.b23c1a98.js"><link rel="prefetch" href="/javanote/assets/js/119.b43f94dd.js"><link rel="prefetch" href="/javanote/assets/js/12.fa4003f9.js"><link rel="prefetch" href="/javanote/assets/js/120.f30ed6c6.js"><link rel="prefetch" href="/javanote/assets/js/121.b0022ef6.js"><link rel="prefetch" href="/javanote/assets/js/122.8fffcc78.js"><link rel="prefetch" href="/javanote/assets/js/123.e3fa7a42.js"><link rel="prefetch" href="/javanote/assets/js/124.58e10cb2.js"><link rel="prefetch" href="/javanote/assets/js/125.1b49d5f0.js"><link rel="prefetch" href="/javanote/assets/js/126.7f8e276b.js"><link rel="prefetch" href="/javanote/assets/js/127.000a6e84.js"><link rel="prefetch" href="/javanote/assets/js/128.18177328.js"><link rel="prefetch" href="/javanote/assets/js/129.0a2b7f4e.js"><link rel="prefetch" href="/javanote/assets/js/13.c51f2bed.js"><link rel="prefetch" href="/javanote/assets/js/130.31bfbbdd.js"><link rel="prefetch" href="/javanote/assets/js/131.dab5fd7f.js"><link rel="prefetch" href="/javanote/assets/js/132.34fb1d32.js"><link rel="prefetch" href="/javanote/assets/js/133.3cc3cb6c.js"><link rel="prefetch" href="/javanote/assets/js/134.8b0d230c.js"><link rel="prefetch" href="/javanote/assets/js/135.905e9937.js"><link rel="prefetch" href="/javanote/assets/js/136.23e19c54.js"><link rel="prefetch" href="/javanote/assets/js/137.3c091787.js"><link rel="prefetch" href="/javanote/assets/js/138.83313b98.js"><link rel="prefetch" href="/javanote/assets/js/139.c8e9d90b.js"><link rel="prefetch" href="/javanote/assets/js/14.8fe80835.js"><link rel="prefetch" href="/javanote/assets/js/140.de3bddcd.js"><link rel="prefetch" href="/javanote/assets/js/141.1575c6e3.js"><link rel="prefetch" href="/javanote/assets/js/142.a6471307.js"><link rel="prefetch" href="/javanote/assets/js/143.ad7eb666.js"><link rel="prefetch" href="/javanote/assets/js/144.c43ced04.js"><link rel="prefetch" href="/javanote/assets/js/145.633601ea.js"><link rel="prefetch" href="/javanote/assets/js/146.b65b7a43.js"><link rel="prefetch" href="/javanote/assets/js/147.f6ba557e.js"><link rel="prefetch" href="/javanote/assets/js/148.046226ae.js"><link rel="prefetch" href="/javanote/assets/js/149.0ad83751.js"><link rel="prefetch" href="/javanote/assets/js/15.414ac078.js"><link rel="prefetch" href="/javanote/assets/js/150.230e4d1c.js"><link rel="prefetch" href="/javanote/assets/js/151.905804f3.js"><link rel="prefetch" href="/javanote/assets/js/152.154b514a.js"><link rel="prefetch" href="/javanote/assets/js/153.37aa1b21.js"><link rel="prefetch" href="/javanote/assets/js/154.76fcd840.js"><link rel="prefetch" href="/javanote/assets/js/155.684e2d46.js"><link rel="prefetch" href="/javanote/assets/js/156.2288654a.js"><link rel="prefetch" href="/javanote/assets/js/157.9550ddf7.js"><link rel="prefetch" href="/javanote/assets/js/158.6f176501.js"><link rel="prefetch" href="/javanote/assets/js/159.38b45246.js"><link rel="prefetch" href="/javanote/assets/js/16.f6bcfda9.js"><link rel="prefetch" href="/javanote/assets/js/160.24484228.js"><link rel="prefetch" href="/javanote/assets/js/161.f8a53ea7.js"><link rel="prefetch" href="/javanote/assets/js/162.91a5d72d.js"><link rel="prefetch" href="/javanote/assets/js/163.2ad88c09.js"><link rel="prefetch" href="/javanote/assets/js/164.4cefc831.js"><link rel="prefetch" href="/javanote/assets/js/165.96d54d27.js"><link rel="prefetch" href="/javanote/assets/js/166.3ced3f05.js"><link rel="prefetch" href="/javanote/assets/js/167.9fd4dada.js"><link rel="prefetch" href="/javanote/assets/js/168.64063340.js"><link rel="prefetch" href="/javanote/assets/js/169.49eefc79.js"><link rel="prefetch" href="/javanote/assets/js/17.5ebaaa3f.js"><link rel="prefetch" href="/javanote/assets/js/170.3938afd5.js"><link rel="prefetch" href="/javanote/assets/js/171.5eb5c5a0.js"><link rel="prefetch" href="/javanote/assets/js/172.a9e33ea2.js"><link rel="prefetch" href="/javanote/assets/js/173.98e6d831.js"><link rel="prefetch" href="/javanote/assets/js/174.03448352.js"><link rel="prefetch" href="/javanote/assets/js/175.64340ac0.js"><link rel="prefetch" href="/javanote/assets/js/176.2dc52060.js"><link rel="prefetch" href="/javanote/assets/js/177.bd69843e.js"><link rel="prefetch" href="/javanote/assets/js/178.59341490.js"><link rel="prefetch" href="/javanote/assets/js/179.cc35c0a6.js"><link rel="prefetch" href="/javanote/assets/js/18.62d03701.js"><link rel="prefetch" href="/javanote/assets/js/180.11ae1e52.js"><link rel="prefetch" href="/javanote/assets/js/181.3e438e5d.js"><link rel="prefetch" href="/javanote/assets/js/182.c53a8efc.js"><link rel="prefetch" href="/javanote/assets/js/183.8b441dfb.js"><link rel="prefetch" href="/javanote/assets/js/184.d7f6c4f5.js"><link rel="prefetch" href="/javanote/assets/js/185.b439d0f4.js"><link rel="prefetch" href="/javanote/assets/js/186.b68e5585.js"><link rel="prefetch" href="/javanote/assets/js/187.56de8200.js"><link rel="prefetch" href="/javanote/assets/js/188.841fcdf2.js"><link rel="prefetch" href="/javanote/assets/js/189.be2262c2.js"><link rel="prefetch" href="/javanote/assets/js/19.0efb6573.js"><link rel="prefetch" href="/javanote/assets/js/190.40a63f47.js"><link rel="prefetch" href="/javanote/assets/js/191.a61a7c80.js"><link rel="prefetch" href="/javanote/assets/js/192.88507421.js"><link rel="prefetch" href="/javanote/assets/js/193.d0a95520.js"><link rel="prefetch" href="/javanote/assets/js/194.c66644e0.js"><link rel="prefetch" href="/javanote/assets/js/195.fdaceef8.js"><link rel="prefetch" href="/javanote/assets/js/196.85a1da29.js"><link rel="prefetch" href="/javanote/assets/js/197.a0b73b7e.js"><link rel="prefetch" href="/javanote/assets/js/198.c46de3af.js"><link rel="prefetch" href="/javanote/assets/js/199.86ad5ea9.js"><link rel="prefetch" href="/javanote/assets/js/2.8a34de3e.js"><link rel="prefetch" href="/javanote/assets/js/20.25232ae5.js"><link rel="prefetch" href="/javanote/assets/js/200.3d524295.js"><link rel="prefetch" href="/javanote/assets/js/201.2352b044.js"><link rel="prefetch" href="/javanote/assets/js/202.c96b8ae2.js"><link rel="prefetch" href="/javanote/assets/js/203.344e4887.js"><link rel="prefetch" href="/javanote/assets/js/204.cedde8a4.js"><link rel="prefetch" href="/javanote/assets/js/205.76202206.js"><link rel="prefetch" href="/javanote/assets/js/206.c4406aa6.js"><link rel="prefetch" href="/javanote/assets/js/207.8a27b698.js"><link rel="prefetch" href="/javanote/assets/js/208.59f5b615.js"><link rel="prefetch" href="/javanote/assets/js/209.fd4a6c64.js"><link rel="prefetch" href="/javanote/assets/js/21.d432caaa.js"><link rel="prefetch" href="/javanote/assets/js/210.b0e3a8d1.js"><link rel="prefetch" href="/javanote/assets/js/211.7cb84367.js"><link rel="prefetch" href="/javanote/assets/js/212.e743f232.js"><link rel="prefetch" href="/javanote/assets/js/213.d50db884.js"><link rel="prefetch" href="/javanote/assets/js/214.6da86c20.js"><link rel="prefetch" href="/javanote/assets/js/215.fd5aa565.js"><link rel="prefetch" href="/javanote/assets/js/216.e95bcc55.js"><link rel="prefetch" href="/javanote/assets/js/217.2231449c.js"><link rel="prefetch" href="/javanote/assets/js/218.b8330003.js"><link rel="prefetch" href="/javanote/assets/js/219.aa7e9cf0.js"><link rel="prefetch" href="/javanote/assets/js/22.53113347.js"><link rel="prefetch" href="/javanote/assets/js/220.9ff6e0e6.js"><link rel="prefetch" href="/javanote/assets/js/23.2238c07a.js"><link rel="prefetch" href="/javanote/assets/js/24.cb7d3039.js"><link rel="prefetch" href="/javanote/assets/js/25.b4eaea24.js"><link rel="prefetch" href="/javanote/assets/js/26.e42a49f7.js"><link rel="prefetch" href="/javanote/assets/js/27.e7587f1f.js"><link rel="prefetch" href="/javanote/assets/js/28.19eae749.js"><link rel="prefetch" href="/javanote/assets/js/29.9ddf7186.js"><link rel="prefetch" href="/javanote/assets/js/3.e91a84a2.js"><link rel="prefetch" href="/javanote/assets/js/30.a380d83f.js"><link rel="prefetch" href="/javanote/assets/js/31.02c44506.js"><link rel="prefetch" href="/javanote/assets/js/32.e4bff71a.js"><link rel="prefetch" href="/javanote/assets/js/33.e26b4f6b.js"><link rel="prefetch" href="/javanote/assets/js/34.187f65f5.js"><link rel="prefetch" href="/javanote/assets/js/35.6cd623a3.js"><link rel="prefetch" href="/javanote/assets/js/36.c018db78.js"><link rel="prefetch" href="/javanote/assets/js/37.fd665c05.js"><link rel="prefetch" href="/javanote/assets/js/38.123aa35e.js"><link rel="prefetch" href="/javanote/assets/js/39.58271e1f.js"><link rel="prefetch" href="/javanote/assets/js/4.953d09eb.js"><link rel="prefetch" href="/javanote/assets/js/40.d588f7b4.js"><link rel="prefetch" href="/javanote/assets/js/41.330ac4ba.js"><link rel="prefetch" href="/javanote/assets/js/42.4d2bcc61.js"><link rel="prefetch" href="/javanote/assets/js/43.e446c0f3.js"><link rel="prefetch" href="/javanote/assets/js/44.77abc34b.js"><link rel="prefetch" href="/javanote/assets/js/45.910e4aa5.js"><link rel="prefetch" href="/javanote/assets/js/46.7f8fd6bb.js"><link rel="prefetch" href="/javanote/assets/js/47.9e340085.js"><link rel="prefetch" href="/javanote/assets/js/48.b4c35e1e.js"><link rel="prefetch" href="/javanote/assets/js/49.807495b7.js"><link rel="prefetch" href="/javanote/assets/js/5.fe579469.js"><link rel="prefetch" href="/javanote/assets/js/50.71cfb288.js"><link rel="prefetch" href="/javanote/assets/js/51.8da13592.js"><link rel="prefetch" href="/javanote/assets/js/52.cf90a64f.js"><link rel="prefetch" href="/javanote/assets/js/53.c685fb7a.js"><link rel="prefetch" href="/javanote/assets/js/54.7d73666a.js"><link rel="prefetch" href="/javanote/assets/js/55.59497bd7.js"><link rel="prefetch" href="/javanote/assets/js/56.22cdda6e.js"><link rel="prefetch" href="/javanote/assets/js/57.36f6ee91.js"><link rel="prefetch" href="/javanote/assets/js/58.6655543d.js"><link rel="prefetch" href="/javanote/assets/js/59.1d073e32.js"><link rel="prefetch" href="/javanote/assets/js/6.1af208a0.js"><link rel="prefetch" href="/javanote/assets/js/60.f782c216.js"><link rel="prefetch" href="/javanote/assets/js/61.4f05bcba.js"><link rel="prefetch" href="/javanote/assets/js/62.d607ed0e.js"><link rel="prefetch" href="/javanote/assets/js/63.0d7a42e8.js"><link rel="prefetch" href="/javanote/assets/js/64.ce15498e.js"><link rel="prefetch" href="/javanote/assets/js/65.b9f31598.js"><link rel="prefetch" href="/javanote/assets/js/66.aeff3690.js"><link rel="prefetch" href="/javanote/assets/js/67.f6f59ffa.js"><link rel="prefetch" href="/javanote/assets/js/68.f875e4ca.js"><link rel="prefetch" href="/javanote/assets/js/69.d6512b6b.js"><link rel="prefetch" href="/javanote/assets/js/7.5739f4db.js"><link rel="prefetch" href="/javanote/assets/js/70.881dc1cf.js"><link rel="prefetch" href="/javanote/assets/js/71.263db750.js"><link rel="prefetch" href="/javanote/assets/js/72.58f08a97.js"><link rel="prefetch" href="/javanote/assets/js/73.df9399d4.js"><link rel="prefetch" href="/javanote/assets/js/74.1d6ddc56.js"><link rel="prefetch" href="/javanote/assets/js/75.fcb30922.js"><link rel="prefetch" href="/javanote/assets/js/76.46a74eb4.js"><link rel="prefetch" href="/javanote/assets/js/77.b5e7728c.js"><link rel="prefetch" href="/javanote/assets/js/78.fcc34355.js"><link rel="prefetch" href="/javanote/assets/js/79.9d5204da.js"><link rel="prefetch" href="/javanote/assets/js/8.26c83b6c.js"><link rel="prefetch" href="/javanote/assets/js/80.672a4f74.js"><link rel="prefetch" href="/javanote/assets/js/81.78acaf25.js"><link rel="prefetch" href="/javanote/assets/js/82.7755c8c3.js"><link rel="prefetch" href="/javanote/assets/js/83.9b495285.js"><link rel="prefetch" href="/javanote/assets/js/84.a1270bb3.js"><link rel="prefetch" href="/javanote/assets/js/85.64d4eb9a.js"><link rel="prefetch" href="/javanote/assets/js/86.9cd6604e.js"><link rel="prefetch" href="/javanote/assets/js/87.588e06ac.js"><link rel="prefetch" href="/javanote/assets/js/88.8dad582a.js"><link rel="prefetch" href="/javanote/assets/js/89.b19689ac.js"><link rel="prefetch" href="/javanote/assets/js/9.51e5d2e7.js"><link rel="prefetch" href="/javanote/assets/js/90.586b9559.js"><link rel="prefetch" href="/javanote/assets/js/91.c9188033.js"><link rel="prefetch" href="/javanote/assets/js/92.69a38839.js"><link rel="prefetch" href="/javanote/assets/js/93.f0c9bdcd.js"><link rel="prefetch" href="/javanote/assets/js/94.f8f6b855.js"><link rel="prefetch" href="/javanote/assets/js/95.a92c2c02.js"><link rel="prefetch" href="/javanote/assets/js/96.ab442531.js"><link rel="prefetch" href="/javanote/assets/js/97.8a60e627.js"><link rel="prefetch" href="/javanote/assets/js/98.3eed55eb.js"><link rel="prefetch" href="/javanote/assets/js/99.b9c138ea.js">
    <link rel="stylesheet" href="/javanote/assets/css/0.styles.1d83b9a0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/javanote/" class="home-link router-link-active"><!----> <span class="site-name">Java全栈</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/basic/java/day01/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/basic/linux/background/" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/basic/mysql/mysql-basic/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/basic/web/WEBday01_HTML-CSS/" class="nav-link">
  web
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级" class="dropdown-title"><span class="title">高级</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级" class="mobile-dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/advance/juc/chapter01/" class="nav-link">
  JUC
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/advance/jvm/chapter01/" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/advance/mysql/chapter01/" class="nav-link">
  MYSQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/rabbitmq/day01/" class="nav-link">
  rabbitmq
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/elasticsearch/day01/" class="nav-link">
  elasticsearch
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/nginx/" class="nav-link">
  nginx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><span class="title">微服务</span> <span class="arrow down"></span></button> <button type="button" aria-label="微服务" class="mobile-dropdown-title"><span class="title">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/springboot/" class="nav-link">
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/springcloud/day01/" class="nav-link">
  springcloud
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/distributed-transaction/" class="nav-link">
  分布式事务
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/tools/git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/tools/maven/maven-overview/" class="nav-link">
  maven
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ssm" class="dropdown-title"><span class="title">ssm</span> <span class="arrow down"></span></button> <button type="button" aria-label="ssm" class="mobile-dropdown-title"><span class="title">ssm</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/ssm/mybatis/preface/" class="nav-link">
  mybatis
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/ssm/spring/AOP-aspect-oriented-programming/agency-model/" class="nav-link">
  spring
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/ssm/springmvc/basic-function/" class="nav-link">
  springmvc
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/others/cryptography/" class="nav-link">
  密码学
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/basic/java/day01/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/basic/linux/background/" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/basic/mysql/mysql-basic/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/basic/web/WEBday01_HTML-CSS/" class="nav-link">
  web
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级" class="dropdown-title"><span class="title">高级</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级" class="mobile-dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/advance/juc/chapter01/" class="nav-link">
  JUC
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/advance/jvm/chapter01/" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/advance/mysql/chapter01/" class="nav-link">
  MYSQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/rabbitmq/day01/" class="nav-link">
  rabbitmq
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/elasticsearch/day01/" class="nav-link">
  elasticsearch
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/middleware/nginx/" class="nav-link">
  nginx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><span class="title">微服务</span> <span class="arrow down"></span></button> <button type="button" aria-label="微服务" class="mobile-dropdown-title"><span class="title">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/springboot/" class="nav-link">
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/springcloud/day01/" class="nav-link">
  springcloud
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/microservice/distributed-transaction/" class="nav-link">
  分布式事务
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/tools/git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/tools/maven/maven-overview/" class="nav-link">
  maven
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ssm" class="dropdown-title"><span class="title">ssm</span> <span class="arrow down"></span></button> <button type="button" aria-label="ssm" class="mobile-dropdown-title"><span class="title">ssm</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/ssm/mybatis/preface/" class="nav-link">
  mybatis
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/ssm/spring/AOP-aspect-oriented-programming/agency-model/" class="nav-link">
  spring
</a></li><li class="dropdown-item"><!----> <a href="/javanote/note/ssm/springmvc/basic-function/" class="nav-link">
  springmvc
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javanote/note/others/cryptography/" class="nav-link">
  密码学
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/javanote/note/basic/web/WEBday01_HTML-CSS/" class="sidebar-link">day01 HTML&amp;CSS</a></li><li><a href="/javanote/note/basic/web/WEBday02_JS&amp;Regular-expression/" class="sidebar-link">day02 JavaScript&amp;正则表达式</a></li><li><a href="/javanote/note/basic/web/WEBday03_VUE&amp;Mall-project-first-phase/" class="sidebar-link">day03 Vue&amp;书城项目第一阶段</a></li><li><a href="/javanote/note/basic/web/WEBday04_XML&amp;Tomcat&amp;Http/" class="sidebar-link">day04 XML&amp;Tomcat&amp;Http协议</a></li><li><a href="/javanote/note/basic/web/WEBday05_Servlet/" class="sidebar-link">day05 Servlet</a></li><li><a href="/javanote/note/basic/web/WEBday06_Request&amp;Response/" class="sidebar-link">day06 Request&amp;Response</a></li><li><a href="/javanote/note/basic/web/WEBday07_The-second-phase-of-the-book-city-project/" class="sidebar-link">day07 书城项目第二阶段</a></li><li><a href="/javanote/note/basic/web/WEBday08_Thymeleaf/" class="sidebar-link">day08 Thmeleaf</a></li><li><a href="/javanote/note/basic/web/WEBday09_The-third-phase-of-the-book-city-project/" class="sidebar-link">day09 书城项目第三阶段</a></li><li><a href="/javanote/note/basic/web/WEBday10_Conversation-&amp;-Book-City-Project-Phase-4/" class="sidebar-link">day10 会话&amp;书城项目第四阶段</a></li><li><a href="/javanote/note/basic/web/WEBday11_The-fourth-phase-of-the-book-city-project/" class="sidebar-link">day11 书城项目第四阶段</a></li><li><a href="/javanote/note/basic/web/WEBday12_Filter&amp;Listenler&amp;Book-City-Project-Phase-5/" aria-current="page" class="active sidebar-link">day12 Filter&amp;Listener&amp;书城项目第五阶段</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javanote/note/basic/web/WEBday12_Filter&amp;Listenler&amp;Book-City-Project-Phase-5/#第一章-filter" class="sidebar-link">第一章 Filter</a></li><li class="sidebar-sub-header"><a href="/javanote/note/basic/web/WEBday12_Filter&amp;Listenler&amp;Book-City-Project-Phase-5/#第二章-扩展案例-使用filter过滤非法字符" class="sidebar-link">第二章 扩展案例: 使用Filter过滤非法字符</a></li><li class="sidebar-sub-header"><a href="/javanote/note/basic/web/WEBday12_Filter&amp;Listenler&amp;Book-City-Project-Phase-5/#第三章-listener" class="sidebar-link">第三章 Listener</a></li><li class="sidebar-sub-header"><a href="/javanote/note/basic/web/WEBday12_Filter&amp;Listenler&amp;Book-City-Project-Phase-5/#第三章-书城项目第五阶段" class="sidebar-link">第三章 书城项目第五阶段</a></li></ul></li><li><a href="/javanote/note/basic/web/WEBday13_Book-City-Project-Phase-5/" class="sidebar-link">day13 书城项目第五阶段</a></li><li><a href="/javanote/note/basic/web/WEBday14_Ajax&amp;Axios&amp;Book-City-Project-Phase-6/" class="sidebar-link">day14 Ajax&amp;Axios&amp;书城项目第六阶段</a></li><li><a href="/javanote/note/basic/web/WEBday15_The-sixth-stage-of-the-book-city-project-&amp;-summary/" class="sidebar-link">day14 Ajax&amp;Axios&amp;书城项目第六阶段</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="day12-filter-listener-书城项目第五阶段"><a href="#day12-filter-listener-书城项目第五阶段" class="header-anchor">#</a> day12 Filter&amp;Listener&amp;书城项目第五阶段</h1> <h2 id="第一章-filter"><a href="#第一章-filter" class="header-anchor">#</a> 第一章 Filter</h2> <h3 id="_1-目标"><a href="#_1-目标" class="header-anchor">#</a> 1. 目标</h3> <ul><li>了解什么是Filter</li> <li>了解Filter的作用</li> <li>掌握Filter的使用</li> <li>了解Filter的生命周期</li> <li>掌握过滤器链的使用</li></ul> <h3 id="_2-内容讲解"><a href="#_2-内容讲解" class="header-anchor">#</a> 2. 内容讲解</h3> <h4 id="_2-1-filter的概念"><a href="#_2-1-filter的概念" class="header-anchor">#</a> 2.1 Filter的概念</h4> <p>Filter：一个实现了特殊接口(Filter)的Java类. 实现对请求资源(jsp,servlet,html,)的过滤的功能.  过滤器是一个运行在服务器的程序, 优先于请求资源(Servlet或者jsp,html)之前执行. 过滤器是javaweb技术中<strong>最为实用</strong>的技术之一</p> <h4 id="_2-2-filter的作用"><a href="#_2-2-filter的作用" class="header-anchor">#</a> 2.2 Filter的作用</h4> <p>Filter的作用是对目标资源(Servlet,jsp)进行过滤，其应用场景有: 登录权限检查,解决网站乱码,过滤敏感字符等等</p> <h4 id="_2-3-filter的入门案例"><a href="#_2-3-filter的入门案例" class="header-anchor">#</a> 2.3 Filter的入门案例</h4> <h5 id="_2-3-1-案例目标"><a href="#_2-3-1-案例目标" class="header-anchor">#</a> 2.3.1 案例目标</h5> <p>实现在请求到达ServletDemo01之前解决请求参数的中文乱码</p> <h5 id="_2-3-2-代码实现"><a href="#_2-3-2-代码实现" class="header-anchor">#</a> 2.3.2 代码实现</h5> <h6 id="_2-3-2-1-创建servletdemo01"><a href="#_2-3-2-1-创建servletdemo01" class="header-anchor">#</a> 2.3.2.1 创建ServletDemo01</h6> <p>web.xml代码</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>servletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.ServletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>servletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/ServletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ServletDemo01代码</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  08:53
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletDemo01</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ServletDemo01接收到了一个请求...&quot;</span><span class="token operator">+</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>前端页面代码</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/webday12/demo01<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如果此时没有Filter，那么客户端发送的请求直接到达ServletDemo01,中文请求参数就会发生乱码</p> <h6 id="_2-3-2-2-创建encodingfilter"><a href="#_2-3-2-2-创建encodingfilter" class="header-anchor">#</a> 2.3.2.2 创建EncodingFilter</h6> <p>web.xml代码</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>encodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.filter.EncodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>encodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--url-pattern表示指定拦截哪些资源--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/demo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>EncodingFilter代码</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  08:56
 * 编写过滤器的步骤:
 * 1. 写一个类实现Filter接口，并且重写方法
 * 2. 在web.xml中配置该过滤器的拦截路径
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EncodingFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> resp<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//解决请求参数的乱码</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> req<span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//每次有请求被当前filter接收到的时候，就会执行doFilter进行过滤处理</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;EncodingFilter接收到了一个请求...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//这句代码表示放行</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-4-filter的生命周期"><a href="#_2-4-filter的生命周期" class="header-anchor">#</a> 2.4 Filter的生命周期</h4> <h5 id="_2-4-1-回顾servlet生命周期"><a href="#_2-4-1-回顾servlet生命周期" class="header-anchor">#</a> 2.4.1 回顾Servlet生命周期</h5> <h6 id="_2-4-1-1-servlet的创建时机"><a href="#_2-4-1-1-servlet的创建时机" class="header-anchor">#</a> 2.4.1.1 Servlet的创建时机</h6> <p>Servlet默认在第一次接收请求的时候创建，我们可以通过<code>&lt;load-on-startup&gt;</code>标签配置Servlet在服务器启动的时候创建</p> <h6 id="_2-4-1-2-servlet的销毁时机"><a href="#_2-4-1-2-servlet的销毁时机" class="header-anchor">#</a> 2.4.1.2 Servlet的销毁时机</h6> <p>Servlet会在服务器关闭或者将项目从服务器上移除的时候销毁</p> <h5 id="_2-4-2-filter的生命周期和生命周期方法"><a href="#_2-4-2-filter的生命周期和生命周期方法" class="header-anchor">#</a> 2.4.2 Filter的生命周期和生命周期方法</h5> <table><thead><tr><th>生命周期阶段</th> <th>执行时机</th> <th>生命周期方法</th></tr></thead> <tbody><tr><td>创建对象</td> <td>Web应用启动时</td> <td>init方法，通常在该方法中做初始化工作</td></tr> <tr><td>拦截请求</td> <td>接收到匹配的请求</td> <td>doFilter方法，通常在该方法中执行拦截过滤</td></tr> <tr><td>销毁</td> <td>Web应用卸载前</td> <td>destroy方法，通常在该方法中执行资源释放</td></tr></tbody></table> <h4 id="_2-5-过滤器匹配规则"><a href="#_2-5-过滤器匹配规则" class="header-anchor">#</a> 2.5 过滤器匹配规则</h4> <h5 id="_2-5-1-过滤器匹配的目的"><a href="#_2-5-1-过滤器匹配的目的" class="header-anchor">#</a> 2.5.1 过滤器匹配的目的</h5> <p>过滤器匹配的目的是指定当前过滤器要拦截哪些资源</p> <h5 id="_2-5-2-四种匹配规则"><a href="#_2-5-2-四种匹配规则" class="header-anchor">#</a> 2.5.2 四种匹配规则</h5> <h6 id="_2-5-2-1-精确匹配"><a href="#_2-5-2-1-精确匹配" class="header-anchor">#</a> 2.5.2.1 精确匹配</h6> <p>指定被拦截资源的完整路径：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 配置Filter要拦截的目标资源 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 指定这个mapping对应的Filter名称 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>FilterDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 通过请求地址模式来设置要拦截的资源 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/demo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>上述例子表示要拦截映射路径为<code>/demo01</code>的这个资源</p> <h6 id="_2-5-2-2-模糊匹配"><a href="#_2-5-2-2-模糊匹配" class="header-anchor">#</a> 2.5.2.2 模糊匹配</h6> <p>相比较精确匹配，使用模糊匹配可以让我们创建一个Filter就能够覆盖很多目标资源，不必专门为每一个目标资源都创建Filter，提高开发效率。</p> <p>在我们配置了url-pattern为/user/*之后，请求地址只要是/user开头的那么就会被匹配。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>Target02Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 模糊匹配：前杠后星 --&gt;</span>
    <span class="token comment">&lt;!--
        /user/demo01
        /user/demo02
        /user/demo03
		/demo04
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/user/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>极端情况：/*匹配所有请求</p> <h6 id="_2-5-2-3-扩展名匹配"><a href="#_2-5-2-3-扩展名匹配" class="header-anchor">#</a> 2.5.2.3 扩展名匹配</h6> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>Target04Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.filter.filter.Target04Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>Target04Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>*.png<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>上述例子表示拦截所有以<code>.png</code>结尾的请求</p> <h6 id="_2-5-2-4-匹配servlet名称"><a href="#_2-5-2-4-匹配servlet名称" class="header-anchor">#</a> 2.5.2.4 匹配Servlet名称</h6> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>Target05Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 根据Servlet名称匹配 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>Target01Servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="_2-6-过滤器链"><a href="#_2-6-过滤器链" class="header-anchor">#</a> 2.6 过滤器链</h4> <h5 id="_2-6-1-过滤链的概念"><a href="#_2-6-1-过滤链的概念" class="header-anchor">#</a> 2.6.1 过滤链的概念</h5> <p>一个请求可能被多个过滤器所过滤，只有当所有过滤器都放行，请求才能到达目标资源，如果有某一个过滤器没有放行，那么请求则无法到达后续过滤器以及目标资源，多个过滤器组成的链路就是过滤器链</p> <p><img alt="images" data-src="/javanote/assets/img/img004.962f5d5c.png" loading="lazy" class="lazy"></p> <h5 id="_2-6-2-过滤器链的顺序"><a href="#_2-6-2-过滤器链的顺序" class="header-anchor">#</a> 2.6.2 过滤器链的顺序</h5> <p>过滤器链中每一个Filter执行的顺序是由web.xml中filter-mapping配置的顺序决定的。</p> <h5 id="_2-6-3-过滤器链案例"><a href="#_2-6-3-过滤器链案例" class="header-anchor">#</a> 2.6.3 过滤器链案例</h5> <h6 id="_2-6-3-1-创建servletdemo01"><a href="#_2-6-3-1-创建servletdemo01" class="header-anchor">#</a> 2.6.3.1 创建ServletDemo01</h6> <p>web.xml代码</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>servletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.ServletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>servletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/ServletDemo01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ServletDemo01代码</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletDemo01</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ServletDemo01接收到了请求...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h6 id="_2-6-3-2-创建多个filter拦截servlet"><a href="#_2-6-3-2-创建多个filter拦截servlet" class="header-anchor">#</a> 2.6.3.2 创建多个Filter拦截Servlet</h6> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>TargetChain03Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/Target05Servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>TargetChain02Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/Target05Servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>TargetChain01Filter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/Target05Servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="第二章-扩展案例-使用filter过滤非法字符"><a href="#第二章-扩展案例-使用filter过滤非法字符" class="header-anchor">#</a> 第二章 扩展案例: 使用Filter过滤非法字符</h2> <h3 id="非法字符过滤案例v1版本"><a href="#非法字符过滤案例v1版本" class="header-anchor">#</a> 非法字符过滤案例V1版本</h3> <h4 id="_1-目标-2"><a href="#_1-目标-2" class="header-anchor">#</a> 1. 目标</h4> <p>判断评论内容中是否包含某个固定的非法字符串，如果包含则请求无法到达CommentServlet</p> <h4 id="_2-代码实现"><a href="#_2-代码实现" class="header-anchor">#</a> 2. 代码实现</h4> <p>前端页面代码</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>评论页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/webday12/illegal/comment<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        评论内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>EncodingFilter的代码，用于解决乱码</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  10:19
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EncodingFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> resp<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//解决乱码</span>
        req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;text/html;charset=UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div><p>IllegalFilter的代码，用于过滤非法字符</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  10:22
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IllegalCharFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> resp<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 获取客户端提交的评论内容</span>
        <span class="token class-name">String</span> content <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//2. 判断content中是否包含非法字符</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;你大爷的&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;评论内容中包含非法字符，评论发布失败!!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>CommentServlet的代码，用于发表评论</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  10:17
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommentServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 获取评论内容</span>
        <span class="token class-name">String</span> content <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. 向客户端输出评论内容</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;恭喜你评论成功，评论内容是:&quot;</span><span class="token operator">+</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>web.xml中的配置</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://xmlns.jcp.org/xml/ns/javaee<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>EncodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.filter.EncodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>EncodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>IllegalCharFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.filter.IllegalCharFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>IllegalCharFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/illegal/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>CommentServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.servlet.CommentServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>CommentServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/illegal/comment<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="非法字符过滤案例v2版本"><a href="#非法字符过滤案例v2版本" class="header-anchor">#</a> 非法字符过滤案例V2版本</h3> <h4 id="_1-目标-3"><a href="#_1-目标-3" class="header-anchor">#</a> 1. 目标</h4> <p>在第一个版本的基础之上，将固定的非法字符串替换成从illegal.txt文件中读取非法字符串</p> <h4 id="_2-代码实现-2"><a href="#_2-代码实现-2" class="header-anchor">#</a> 2. 代码实现</h4> <p>IllegalFilter的代码</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">BufferedReader</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStreamReader</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  10:22
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IllegalCharFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> illegalTextList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> resp<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 获取客户端提交的评论内容</span>
        <span class="token class-name">String</span> content <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//3. 判断content中是否包含非法字符</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> illegalText <span class="token operator">:</span> illegalTextList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>illegalText<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;评论内容中包含非法字符，评论发布失败!!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token comment">//在这里读取illegal.txt文件,就只需要在项目部署的时候读取一次</span>
        <span class="token comment">//将字节输入流进行包装---&gt;InputStreamReader()-----&gt;BufferedReader()----&gt;readLine</span>
        <span class="token class-name">BufferedReader</span> bufferedReader <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            bufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span><span class="token class-name">IllegalCharFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;illegal.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> illegalText <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>illegalText <span class="token operator">=</span> bufferedReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//将读到的那个字符串存储到集合中</span>
                illegalTextList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>illegalText<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                bufferedReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>其它的代码和V1版本相同</p> <h3 id="非法字符过滤案例v3版本"><a href="#非法字符过滤案例v3版本" class="header-anchor">#</a> 非法字符过滤案例V3版本</h3> <h4 id="_1-目标-4"><a href="#_1-目标-4" class="header-anchor">#</a> 1.目标</h4> <p>在第二版本的基础上，实现CommentServlet发布评论内容的时候将评论内容中的非法字符替换成*</p> <h4 id="_2-代码实现-3"><a href="#_2-代码实现-3" class="header-anchor">#</a> 2. 代码实现</h4> <p>IllegalFilter的代码</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">BufferedReader</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStreamReader</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">InvocationHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Proxy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  10:22
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IllegalCharFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> illegalTextList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> resp<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//使用动态代理改变req对象的getParameter方法</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> req<span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServletRequest</span><span class="token punctuation">&gt;</span></span> clazz <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HttpServletRequest</span> proxyRequest <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>clazz<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> clazz<span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                <span class="token comment">//改变getParameter()方法</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;getParameter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token comment">//1. 调用原本的getParameter()方法，先获取到请求参数</span>
                    <span class="token class-name">String</span> oldValue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">//2. 判断oldValue中是否包含非法字符，如果包含则将非法字符替换成*</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> illegalText <span class="token operator">:</span> illegalTextList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>oldValue<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>illegalText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                            <span class="token comment">//非法字符串有几个字符就生成几个*</span>
                            <span class="token class-name">String</span> star <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> illegalText<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                star <span class="token operator">+=</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token comment">//然后使用star替换oldValue中的非法字符串</span>
                            oldValue <span class="token operator">=</span> oldValue<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>illegalText<span class="token punctuation">,</span>star<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//放行过去的请求，一定要是代理请求</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>proxyRequest<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token comment">//在这里读取illegal.txt文件,就只需要在项目部署的时候读取一次</span>
        <span class="token comment">//将字节输入流进行包装---&gt;InputStreamReader()-----&gt;BufferedReader()----&gt;readLine</span>
        <span class="token class-name">BufferedReader</span> bufferedReader <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            bufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span><span class="token class-name">IllegalCharFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;illegal.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> illegalText <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>illegalText <span class="token operator">=</span> bufferedReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//将读到的那个字符串存储到集合中</span>
                illegalTextList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>illegalText<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                bufferedReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其它代码和V2版本相同</p> <h2 id="第三章-listener"><a href="#第三章-listener" class="header-anchor">#</a> 第三章 Listener</h2> <h3 id="_1-目标-5"><a href="#_1-目标-5" class="header-anchor">#</a> 1. 目标</h3> <ul><li>了解观察者模式</li> <li>了解监听器的概念</li> <li>掌握ServletContextListener的使用</li></ul> <h3 id="_2-内容讲解-2"><a href="#_2-内容讲解-2" class="header-anchor">#</a> 2. 内容讲解</h3> <h4 id="_2-1-观察者模式简介"><a href="#_2-1-观察者模式简介" class="header-anchor">#</a> 2.1 观察者模式简介</h4> <p>观察者模式是二十三中设计模式之一，它是指多个对象间存在一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。这种模式有时又称作发布-订阅模式</p> <p><img alt="images" data-src="/javanote/assets/img/img001.e0262273.png" loading="lazy" class="lazy"></p> <ul><li>观察者：监控『被观察者』的行为，一旦发现『被观察者』触发了事件，就会调用事先准备好的方法执行操作。</li> <li>被观察者：『被观察者』一旦触发了被监控的事件，就会被『观察者』发现。</li></ul> <h4 id="_2-2-监听器的简介"><a href="#_2-2-监听器的简介" class="header-anchor">#</a> 2.2 监听器的简介</h4> <h5 id="_2-2-1-监听器的概念"><a href="#_2-2-1-监听器的概念" class="header-anchor">#</a> 2.2.1 监听器的概念</h5> <p>监听器：专门用于对其他对象身上发生的事件或状态改变进行监听和相应处理的对象，当被监视的对象发生情况时，立即采取相应的行动。
Servlet监听器：Servlet规范中定义的一种特殊类，它用于监听Web应用程序中的ServletContext，HttpSession 和HttpServletRequest等域对象的创建与销毁事件，以及监听这些域对象中的属性发生修改的事件。</p> <h5 id="_2-2-2-servlet监听器的分类-了解"><a href="#_2-2-2-servlet监听器的分类-了解" class="header-anchor">#</a> 2.2.2 Servlet监听器的分类(了解)</h5> <h6 id="_2-2-2-1-servletcontextlistener"><a href="#_2-2-2-1-servletcontextlistener" class="header-anchor">#</a> 2.2.2.1 ServletContextListener</h6> <p>作用：监听ServletContext对象的创建与销毁</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>contextInitialized(ServletContextEvent sce)</td> <td>ServletContext创建时调用</td></tr> <tr><td>contextDestroyed(ServletContextEvent sce)</td> <td>ServletContext销毁时调用</td></tr></tbody></table> <p>ServletContextEvent对象代表从ServletContext对象身上捕获到的事件，通过这个事件对象我们可以获取到ServletContext对象。</p> <h6 id="_2-2-2-2-httpsessionlistener"><a href="#_2-2-2-2-httpsessionlistener" class="header-anchor">#</a> 2.2.2.2 HttpSessionListener</h6> <p>作用：监听HttpSession对象的创建与销毁</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>sessionCreated(HttpSessionEvent hse)</td> <td>HttpSession对象创建时调用</td></tr> <tr><td>sessionDestroyed(HttpSessionEvent hse)</td> <td>HttpSession对象销毁时调用</td></tr></tbody></table> <p>HttpSessionEvent对象代表从HttpSession对象身上捕获到的事件，通过这个事件对象我们可以获取到触发事件的HttpSession对象。</p> <h6 id="_2-2-2-3-servletrequestlistener"><a href="#_2-2-2-3-servletrequestlistener" class="header-anchor">#</a> 2.2.2.3 ServletRequestListener</h6> <p>作用：监听ServletRequest对象的创建与销毁</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>requestInitialized(ServletRequestEvent sre)</td> <td>ServletRequest对象创建时调用</td></tr> <tr><td>requestDestroyed(ServletRequestEvent sre)</td> <td>ServletRequest对象销毁时调用</td></tr></tbody></table> <p>ServletRequestEvent对象代表从HttpServletRequest对象身上捕获到的事件，通过这个事件对象我们可以获取到触发事件的HttpServletRequest对象。另外还有一个方法可以获取到当前Web应用的ServletContext对象。</p> <h6 id="_2-2-2-4-servletcontextattributelistener"><a href="#_2-2-2-4-servletcontextattributelistener" class="header-anchor">#</a> 2.2.2.4 ServletContextAttributeListener</h6> <p>作用：监听ServletContext中属性的创建、修改和销毁</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>attributeAdded(ServletContextAttributeEvent scab)</td> <td>向ServletContext中添加属性时调用</td></tr> <tr><td>attributeRemoved(ServletContextAttributeEvent scab)</td> <td>从ServletContext中移除属性时调用</td></tr> <tr><td>attributeReplaced(ServletContextAttributeEvent scab)</td> <td>当ServletContext中的属性被修改时调用</td></tr></tbody></table> <p>ServletContextAttributeEvent对象代表属性变化事件，它包含的方法如下：</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>getName()</td> <td>获取修改或添加的属性名</td></tr> <tr><td>getValue()</td> <td>获取被修改或添加的属性值</td></tr> <tr><td>getServletContext()</td> <td>获取ServletContext对象</td></tr></tbody></table> <h6 id="_2-2-2-5-httpsessionattributelistener"><a href="#_2-2-2-5-httpsessionattributelistener" class="header-anchor">#</a> 2.2.2.5 HttpSessionAttributeListener</h6> <p>作用：监听HttpSession中属性的创建、修改和销毁</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>attributeAdded(HttpSessionBindingEvent se)</td> <td>向HttpSession中添加属性时调用</td></tr> <tr><td>attributeRemoved(HttpSessionBindingEvent se)</td> <td>从HttpSession中移除属性时调用</td></tr> <tr><td>attributeReplaced(HttpSessionBindingEvent se)</td> <td>当HttpSession中的属性被修改时调用</td></tr></tbody></table> <p>HttpSessionBindingEvent对象代表属性变化事件，它包含的方法如下：</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>getName()</td> <td>获取修改或添加的属性名</td></tr> <tr><td>getValue()</td> <td>获取被修改或添加的属性值</td></tr> <tr><td>getSession()</td> <td>获取触发事件的HttpSession对象</td></tr></tbody></table> <h6 id="_2-2-2-6-servletrequestattributelistener"><a href="#_2-2-2-6-servletrequestattributelistener" class="header-anchor">#</a> 2.2.2.6 ServletRequestAttributeListener</h6> <p>作用：监听ServletRequest中属性的创建、修改和销毁</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>attributeAdded(ServletRequestAttributeEvent srae)</td> <td>向ServletRequest中添加属性时调用</td></tr> <tr><td>attributeRemoved(ServletRequestAttributeEvent srae)</td> <td>从ServletRequest中移除属性时调用</td></tr> <tr><td>attributeReplaced(ServletRequestAttributeEvent srae)</td> <td>当ServletRequest中的属性被修改时调用</td></tr></tbody></table> <p>ServletRequestAttributeEvent对象代表属性变化事件，它包含的方法如下：</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>getName()</td> <td>获取修改或添加的属性名</td></tr> <tr><td>getValue()</td> <td>获取被修改或添加的属性值</td></tr> <tr><td>getServletRequest ()</td> <td>获取触发事件的ServletRequest对象</td></tr></tbody></table> <h6 id="_2-2-2-7-httpsessionbindinglistener"><a href="#_2-2-2-7-httpsessionbindinglistener" class="header-anchor">#</a> 2.2.2.7 HttpSessionBindingListener</h6> <p>作用：监听某个对象在Session域中的创建与移除</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>valueBound(HttpSessionBindingEvent event)</td> <td>该类的实例被放到Session域中时调用</td></tr> <tr><td>valueUnbound(HttpSessionBindingEvent event)</td> <td>该类的实例从Session中移除时调用</td></tr></tbody></table> <p>HttpSessionBindingEvent对象代表属性变化事件，它包含的方法如下：</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>getName()</td> <td>获取当前事件涉及的属性名</td></tr> <tr><td>getValue()</td> <td>获取当前事件涉及的属性值</td></tr> <tr><td>getSession()</td> <td>获取触发事件的HttpSession对象</td></tr></tbody></table> <h6 id="_2-2-2-8-httpsessionactivationlistener"><a href="#_2-2-2-8-httpsessionactivationlistener" class="header-anchor">#</a> 2.2.2.8 HttpSessionActivationListener</h6> <p>作用：监听某个对象在Session中的序列化与反序列化。</p> <table><thead><tr><th>方法名</th> <th>作用</th></tr></thead> <tbody><tr><td>sessionWillPassivate(HttpSessionEvent se)</td> <td>该类实例和Session一起钝化到硬盘时调用</td></tr> <tr><td>sessionDidActivate(HttpSessionEvent se)</td> <td>该类实例和Session一起活化到内存时调用</td></tr></tbody></table> <p>HttpSessionEvent对象代表事件对象，通过getSession()方法获取事件涉及的HttpSession对象。</p> <h4 id="_2-3-servletcontextlistener的使用"><a href="#_2-3-servletcontextlistener的使用" class="header-anchor">#</a> 2.3 ServletContextListener的使用</h4> <h5 id="_2-3-1-作用"><a href="#_2-3-1-作用" class="header-anchor">#</a> 2.3.1 作用</h5> <p>ServletContextListener是监听ServletContext对象的创建和销毁的，因为ServletContext对象是在服务器启动的时候创建、在服务器关闭的时候销毁，所以ServletContextListener也可以监听服务器的启动和关闭</p> <h5 id="_2-3-2-使用场景"><a href="#_2-3-2-使用场景" class="header-anchor">#</a> 2.3.2 使用场景</h5> <p>将来学习SpringMVC的时候，会用到一个ContextLoaderListener，这个监听器就实现了ServletContextListener接口，表示对ServletContext对象本身的生命周期进行监控。</p> <h5 id="_2-3-3-代码实现"><a href="#_2-3-3-代码实现" class="header-anchor">#</a> 2.3.3 代码实现</h5> <h6 id="_2-3-3-1-创建监听器类"><a href="#_2-3-3-1-创建监听器类" class="header-anchor">#</a> 2.3.3.1 创建监听器类</h6> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>listener</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletContextEvent</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletContextListener</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 包名:com.atguigu.listener
 *
 * @author Leevi
 * 日期2021-05-18  14:10
 * ServletContextLisneter监听器可以监听服务器的启动和关闭
 * 1. contextInitialized()方法可以监听服务器的启动
 * 2. contextDestroyed()方法可以监听服务器的关闭
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyContextListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> sce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;服务器启动了...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> sce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;服务器关闭了...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h6 id="_2-3-3-2-注册监听器"><a href="#_2-3-3-2-注册监听器" class="header-anchor">#</a> 2.3.3.2 注册监听器</h6> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!--配置Listener--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.listener.MyContextListener<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="第三章-书城项目第五阶段"><a href="#第三章-书城项目第五阶段" class="header-anchor">#</a> 第三章 书城项目第五阶段</h2> <h3 id="功能一-登录检查"><a href="#功能一-登录检查" class="header-anchor">#</a> 功能一 登录检查</h3> <h4 id="_1-1-目标"><a href="#_1-1-目标" class="header-anchor">#</a> 1.1 目标</h4> <p>把项目中需要保护的功能保护起来，没有登录不允许访问。但是我们不考虑后台登录检查，仅完成前台登录检查。</p> <ul><li>购物车功能</li> <li>订单功能</li></ul> <h4 id="_1-2-思路"><a href="#_1-2-思路" class="header-anchor">#</a> 1.2 思路</h4> <p><img alt="images" data-src="data:image/png;base64,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" loading="lazy" class="lazy"></p> <h4 id="_1-3-代码实现"><a href="#_1-3-代码实现" class="header-anchor">#</a> 1.3 代码实现</h4> <h5 id="_1-3-1-拦截受保护资源的请求"><a href="#_1-3-1-拦截受保护资源的请求" class="header-anchor">#</a> 1.3.1 拦截受保护资源的请求</h5> <ol><li><p>修改受保护的Servlet的映射路径</p> <p>购物车资源地址：<code>/protected/CartServlet</code></p> <p>订单资源地址(明天学)：<code>/protected/OrderServlet</code></p></li> <li><p>Filter拦截的地址：<code>/protected/*</code></p></li></ol> <h5 id="_1-3-2-对访问购物车资源的地址进行修改"><a href="#_1-3-2-对访问购物车资源的地址进行修改" class="header-anchor">#</a> 1.3.2 对访问购物车资源的地址进行修改</h5> <h6 id="_1-3-2-1-首页加入购物车"><a href="#_1-3-2-1-首页加入购物车" class="header-anchor">#</a> 1.3.2.1 首页加入购物车</h6> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/protected/cart(method=<span class="token punctuation">'</span>addCartItem<span class="token punctuation">'</span>,id=${book.bookId})}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>加入购物车<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h6 id="_1-3-2-2-首页登录状态和未登录状态显示购物车"><a href="#_1-3-2-2-首页登录状态和未登录状态显示购物车" class="header-anchor">#</a> 1.3.2.2 首页登录状态和未登录状态显示购物车</h6> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>protected/cart?method=toCartPage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cart iconfont icon-gouwuche<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    购物车
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h6 id="_1-3-2-3-cart-html清空购物车"><a href="#_1-3-2-3-cart-html清空购物车" class="header-anchor">#</a> 1.3.2.3 cart.html清空购物车</h6> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>protected/cart?method=cleanCart<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cleanCart<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clear-cart<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>清空购物车<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h6 id="_1-3-2-4-cart-html删除超链接"><a href="#_1-3-2-4-cart-html删除超链接" class="header-anchor">#</a> 1.3.2.4 cart.html删除超链接</h6> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/protected/cart(method=<span class="token punctuation">'</span>removeCartItem<span class="token punctuation">'</span>,id=${cartItemEntry.value.bookId})}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deleteCartItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>删除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h6 id="_1-3-2-5-cart-html中的加号和减号"><a href="#_1-3-2-5-cart-html中的加号和减号" class="header-anchor">#</a> 1.3.2.5 cart.html中的加号和减号</h6> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--减号--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">cartItemCountDecrease</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/protected/cart(method=<span class="token punctuation">'</span>countDecrease<span class="token punctuation">'</span>,id=${cartItemEntry.value.bookId})}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--加号--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/protected/cart(method=<span class="token punctuation">'</span>countIncrease<span class="token punctuation">'</span>,id=${cartItemEntry.value.bookId})}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h6 id="_1-3-2-5-cart-html中vue代码"><a href="#_1-3-2-5-cart-html中vue代码" class="header-anchor">#</a> 1.3.2.5 cart.html中Vue代码</h6> <p>凡是涉及到location.href都需要修改：</p> <div class="language-html extra-class"><pre class="language-html"><code>location.href = &quot;protected/cart?method=updateCartItemCount&amp;id=&quot;+bookId+&quot;&amp;newCount=&quot;+newCount
</code></pre></div><h5 id="_1-3-3-web-xml中修改cartservlet的url-pattern"><a href="#_1-3-3-web-xml中修改cartservlet的url-pattern" class="header-anchor">#</a> 1.3.3 web.xml中修改CartServlet的url-pattern</h5> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>CartServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.servlet.model.CartServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>CartServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/protected/cart<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h5 id="_1-3-4-创建执行登录检查的filter"><a href="#_1-3-4-创建执行登录检查的filter" class="header-anchor">#</a> 1.3.4 创建执行登录检查的Filter</h5> <h6 id="_1-3-4-1-filter类"><a href="#_1-3-4-1-filter类" class="header-anchor">#</a> 1.3.4.1 Filter类</h6> <p><img alt="images" data-src="http://heavy_code_industry.gitee.io/code_heavy_industry/pro001-javaweb/lecture/bookstore05/images/img002.png" loading="lazy" class="lazy"></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>constant<span class="token punctuation">.</span></span><span class="token class-name">BookStoreConstants</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpSession</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Leevi
 * 日期2021-05-18  14:20
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> resp<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 判断当前是否已登录</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> req<span class="token punctuation">;</span>
        <span class="token class-name">HttpServletResponse</span> response <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">)</span> resp<span class="token punctuation">;</span>

        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> loginUser <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">BookStoreConstants</span><span class="token punctuation">.</span>USERSESSIONKEY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>loginUser <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//往request域对象中存储errorMessage</span>
            request<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;errorMessage&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;请先登录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2. 如果未登录则跳转到登录页面</span>
            request<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">&quot;/user?method=toLoginPage&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//3. 如果已登录，则放行</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h6 id="_1-3-4-2-在web-xml中注册filter类"><a href="#_1-3-4-2-在web-xml中注册filter类" class="header-anchor">#</a> 1.3.4.2 在web.xml中注册Filter类</h6> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>LoginFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>com.atguigu.filter.LoginFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>LoginFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/protected/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/javanote/note/basic/web/WEBday11_The-fourth-phase-of-the-book-city-project/" class="prev">
        day11 书城项目第四阶段
      </a></span> <span class="next"><a href="/javanote/note/basic/web/WEBday13_Book-City-Project-Phase-5/">
        day13 书城项目第五阶段
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/javanote/assets/js/app.4d8a0605.js" defer></script><script src="/javanote/assets/js/11.31b4bfe5.js" defer></script><script src="/javanote/assets/js/101.cf545769.js" defer></script>
  </body>
</html>
